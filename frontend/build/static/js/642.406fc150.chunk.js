"use strict";(self.webpackChunkmama_miracle_boutique_frontend=self.webpackChunkmama_miracle_boutique_frontend||[]).push([[642],{588:(e,s,t)=>{t.d(s,{A:()=>l});t(5043);var a=t(579);const l=()=>(0,a.jsx)("div",{className:"flex justify-center items-center min-h-[40vh] sm:min-h-screen w-full",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 sm:h-12 sm:w-12 border-t-2 border-b-2 border-blue-500"})})},7642:(e,s,t)=>{t.r(s),t.d(s,{default:()=>v});var a=t(5043),l=t(3003),r=t(5475),d=t(9751),i=t(7227),n=t(963),c=t(588),o=t(3204),x=t(4961),m=t(9367),h=t(6058),p=t(2774),g=t(9722),u=t(579);const b=function(e){var s;let{token:t}=e;const[l,r]=(0,a.useState)(null),[d,i]=(0,a.useState)(!0),[n,c]=(0,a.useState)(""),{t:o}=(0,x.B)();return(0,a.useEffect)((()=>{g.A.get("/api/admin/analytics",{headers:{Authorization:"Bearer ".concat(t)}}).then((e=>r(e.data))).catch((()=>c("Failed to fetch analytics"))).finally((()=>i(!1)))}),[t]),d?(0,u.jsx)("div",{className:"text-center py-4",children:"Loading analytics..."}):n?(0,u.jsxs)("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg flex items-center",children:[(0,u.jsx)(p.TNq,{className:"mr-2"}),n]}):l?(0,u.jsxs)("div",{className:"mb-8",children:[(0,u.jsxs)("div",{className:"flex items-center mb-4",children:[(0,u.jsx)(p.YYR,{className:"text-primary-600 mr-2"}),(0,u.jsx)("h2",{className:"text-xl font-bold text-primary-700",children:o("advancedAnalytics")})]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow p-4",children:[(0,u.jsx)("h3",{className:"text-sm text-gray-500 mb-1",children:o("totalSales")}),(0,u.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:["\u20a6",(null===(s=l.salesTotal)||void 0===s?void 0:s.toLocaleString())||0]})]}),(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow p-4",children:[(0,u.jsx)("h3",{className:"text-sm text-gray-500 mb-1",children:o("totalOrders")}),(0,u.jsx)("p",{className:"text-2xl font-bold text-green-600",children:l.orderCount||0})]}),(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow p-4",children:[(0,u.jsx)("h3",{className:"text-sm text-gray-500 mb-1",children:o("lowStockItems")}),(0,u.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:l.lowStockCount||0})]})]}),l.additionalMetrics&&(0,u.jsxs)("div",{className:"mt-4 bg-white rounded-xl shadow p-4",children:[(0,u.jsx)("h3",{className:"font-bold mb-2",children:o("additionalMetrics")}),(0,u.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(l.additionalMetrics).map((e=>{let[s,t]=e;return(0,u.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,u.jsx)("p",{className:"text-sm text-gray-600",children:o(s)}),(0,u.jsx)("p",{className:"text-lg font-bold text-primary-600",children:t})]},s)}))})]})]}):null};var j=t(8631),N=t(8550),y=t(7304);y.t1.register(y.PP,y.kc,y.FN,y.No,y.E8,y.hE,y.m_,y.s$,y.Bs,y.dN);const v=()=>{var e,s;const t=(0,l.wA)(),{users:g=[],isLoading:y}=(0,l.d4)((e=>e.user)),{products:v=[],isLoading:f}=(0,l.d4)((e=>e.product)),{orders:w=[],isLoading:k}=(0,l.d4)((e=>e.order)),[S,A]=(0,a.useState)([]),[F,C]=(0,a.useState)(!0),[O,P]=(0,a.useState)(""),[_,B]=(0,a.useState)([]),[L,I]=(0,a.useState)([]),[D,M]=(0,a.useState)(!0),[E,J]=(0,a.useState)(""),[Y,H]=(0,a.useState)([]),[q,V]=(0,a.useState)([]),[z,R]=(0,a.useState)({}),[T,U]=(0,a.useState)({}),[X,$]=(0,a.useState)((new Date).getFullYear()),{user:Q}=(0,l.d4)((e=>e.auth)),{t:W}=(0,x.B)();if((0,a.useEffect)((()=>{t((0,d.lo)()),t((0,i.d$)()),t((0,n.WF)());null!==Q&&void 0!==Q&&Q.isAdmin&&(async()=>{C(!0),P("");try{const e=await o.A.get("/api/products/low-stock",{headers:{Authorization:"Bearer ".concat(null===Q||void 0===Q?void 0:Q.token)}});A(e.data.products||[])}catch(e){P("Failed to fetch low stock products")}finally{C(!1)}})()}),[t,Q]),(0,a.useEffect)((()=>{(async()=>{M(!0),J("");try{const e=X,s=await o.A.get("/api/sales-stats/yearly?year=".concat(e));B(s.data||[]);const t=await o.A.get("/api/sales-stats/total?year=".concat(e));R(t.data||{totalSales:0,totalOrders:0});const a=await o.A.get("/api/users"),l=Array(12).fill(0);a.data.forEach((s=>{const t=new Date(s.createdAt);t.getFullYear()===e&&l[t.getMonth()]++})),I(l);const r=await o.A.get("/api/orders/aggregate/top-products?year=".concat(e));H(r.data||[]);const d=await o.A.get("/api/orders/aggregate/sales-by-category?year=".concat(e));V(d.data||[]);const i=v.filter((e=>e.countInStock>0)).length,n=v.filter((e=>0===e.countInStock)).length,c=v.filter((e=>e.countInStock>0&&e.countInStock<=5)).length,x=v.reduce(((e,s)=>e+s.price*s.countInStock),0);U({inStock:i,outOfStock:n,lowStock:c,totalValue:x})}catch(e){J("Failed to fetch analytics data")}finally{M(!1)}})()}),[v,X]),y||f||k)return(0,u.jsx)(c.A,{});const G=w.reduce(((e,s)=>e+(s.totalPrice||0)),0),K=w.slice(-5).reverse(),Z=w.length>0?G/w.length:0,ee=w.filter((e=>e.isPaid)).length,se=w.length>0?(ee/w.length*100).toFixed(1):0,te=(new Date).getFullYear(),ae=[];for(let a=te-2;a<=te;a++)ae.push(a);const le=(null===Q||void 0===Q?void 0:Q.token)||(localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")).token:"");return(0,u.jsxs)("div",{className:"container mx-auto px-2 sm:px-4 py-10",children:[(0,u.jsxs)(m.mg,{children:[(0,u.jsx)("title",{children:"Admin Dashboard - Judith's Haven"}),(0,u.jsx)("meta",{name:"description",content:"Admin dashboard for managing users, products, orders, and analytics at Judith's Haven."}),(0,u.jsx)("link",{rel:"canonical",href:"https://yourdomain.com/admin/dashboard"})]}),(0,u.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,u.jsx)("h1",{className:"text-3xl font-extrabold mb-6 text-primary-700 tracking-tight drop-shadow-lg text-center",children:W("adminDashboard")}),le&&(0,u.jsx)(b,{token:le}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-10",children:[(0,u.jsx)(j.A,{token:le}),(0,u.jsx)(N.A,{token:le})]}),(0,u.jsx)("div",{className:"flex justify-center items-center mb-8 gap-4",children:(0,u.jsxs)("div",{className:"flex items-center",children:[(0,u.jsxs)("label",{htmlFor:"year-select",className:"mr-2 text-gray-700",children:[W("year"),":"]}),(0,u.jsx)("select",{id:"year-select",value:X,onChange:e=>$(Number(e.target.value)),className:"rounded border border-gray-300 px-2 py-1 focus:outline-none focus:ring-2 focus:ring-primary-400",children:ae.map((e=>(0,u.jsx)("option",{value:e,children:e},e)))})]})}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow p-4 flex items-center",children:[(0,u.jsx)("div",{className:"rounded-full bg-blue-100 p-3 mr-4",children:(0,u.jsx)(p.MxO,{className:"text-blue-500 text-xl"})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:"text-sm text-gray-500",children:W("totalSales")}),(0,u.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:["\u20a6",G.toLocaleString()]}),(0,u.jsxs)("p",{className:"text-xs text-gray-500",children:[z.totalOrders||0," ",W("orders")]})]})]}),(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow p-4 flex items-center",children:[(0,u.jsx)("div",{className:"rounded-full bg-green-100 p-3 mr-4",children:(0,u.jsx)(p.YXz,{className:"text-green-500 text-xl"})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:"text-sm text-gray-500",children:W("totalUsers")}),(0,u.jsx)("p",{className:"text-2xl font-bold text-green-600",children:g.length}),(0,u.jsxs)("p",{className:"text-xs text-gray-500",children:[L.reduce(((e,s)=>e+s),0)," ",W("newThisYear")]})]})]}),(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow p-4 flex items-center",children:[(0,u.jsx)("div",{className:"rounded-full bg-purple-100 p-3 mr-4",children:(0,u.jsx)(p.H5e,{className:"text-purple-500 text-xl"})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:"text-sm text-gray-500",children:W("inventory")}),(0,u.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:v.length}),(0,u.jsxs)("p",{className:"text-xs text-gray-500",children:["\u20a6",(null===(e=T.totalValue)||void 0===e?void 0:e.toLocaleString())||0," ",W("value")]})]})]}),(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow p-4 flex items-center",children:[(0,u.jsx)("div",{className:"rounded-full bg-yellow-100 p-3 mr-4",children:(0,u.jsx)(p.AsH,{className:"text-yellow-500 text-xl"})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:"text-sm text-gray-500",children:W("avgOrderValue")}),(0,u.jsxs)("p",{className:"text-2xl font-bold text-yellow-600",children:["\u20a6",Z.toLocaleString(void 0,{maximumFractionDigits:0})]}),(0,u.jsxs)("p",{className:"text-xs text-gray-500",children:[se,"% ",W("conversionRate")]})]})]})]}),(0,u.jsx)("div",{className:"mb-10",children:D?(0,u.jsx)("div",{children:"Loading analytics..."}):E?(0,u.jsx)("div",{className:"text-red-500",children:E}):(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow p-4",children:[(0,u.jsx)("h3",{className:"font-bold mb-2",children:W("monthlySales")}),(0,u.jsx)(h.N1,{data:{labels:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],datasets:[{label:W("sales")+" (\u20a6)",data:_.map((e=>e.totalSales)),borderColor:"rgba(75,192,192,1)",backgroundColor:"rgba(75,192,192,0.2)",tension:.3,fill:!0},{label:W("orders"),data:_.map((e=>e.totalOrders)),borderColor:"rgba(255,99,132,1)",backgroundColor:"rgba(255,99,132,0.2)",tension:.3,fill:!1,yAxisID:"y1"}]},options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!1}},scales:{y1:{position:"right",grid:{drawOnChartArea:!1}}}}})]}),(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow p-4",children:[(0,u.jsxs)("h3",{className:"font-bold mb-2",children:[W("userRegistrations")," (",W("monthly"),")"]}),(0,u.jsx)(h.yP,{data:{labels:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],datasets:[{label:W("users"),data:L,backgroundColor:"rgba(54,162,235,0.5)"}]},options:{responsive:!0,plugins:{legend:{display:!1},title:{display:!1}}}})]})]})}),(0,u.jsx)("div",{className:"mb-10",children:D?null:(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow p-4",children:[(0,u.jsxs)("h3",{className:"font-bold mb-2",children:[W("top5Products")," (",W("byQuantitySold"),")"]}),(0,u.jsx)(h.yP,{data:{labels:Y.map((e=>e.name)),datasets:[{label:W("quantitySold"),data:Y.map((e=>e.totalSold)),backgroundColor:"rgba(255, 159, 64, 0.7)"},{label:W("revenue")+" (\u20a6)",data:Y.map((e=>e.totalRevenue)),backgroundColor:"rgba(54, 162, 235, 0.4)",yAxisID:"y1"}]},options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!1}},scales:{y1:{position:"right",grid:{drawOnChartArea:!1}}}}})]}),(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow p-4",children:[(0,u.jsx)("h3",{className:"font-bold mb-2",children:W("salesByCategory")}),(0,u.jsx)(h.Fq,{data:{labels:q.map((e=>e.categoryName||"Unknown")),datasets:[{label:W("sales")+" (\u20a6)",data:q.map((e=>e.totalSales)),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#C9CBCF","#B2FF66","#FF66B2","#66B2FF"]}]},options:{responsive:!0,plugins:{legend:{position:"right"},title:{display:!1}}}})]})]})}),(0,u.jsx)("div",{className:"mb-10",children:D?null:(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow p-4",children:[(0,u.jsx)("h3",{className:"font-bold mb-2",children:W("inventoryStatus")}),(0,u.jsx)(h.nu,{data:{labels:[W("inStock"),W("lowStock"),W("outOfStock")],datasets:[{data:[T.inStock-T.lowStock,T.lowStock,T.outOfStock],backgroundColor:["#4BC0C0","#FFCE56","#FF6384"]}]},options:{responsive:!0,plugins:{legend:{position:"right"},title:{display:!1}}}})]}),(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow p-4 flex flex-col justify-center",children:[(0,u.jsx)("h3",{className:"font-bold mb-4",children:W("inventoryMetrics")}),(0,u.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,u.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,u.jsx)("p",{className:"text-sm text-gray-600",children:W("totalProducts")}),(0,u.jsx)("p",{className:"text-2xl font-bold text-green-600",children:v.length})]}),(0,u.jsxs)("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[(0,u.jsx)("p",{className:"text-sm text-gray-600",children:W("lowStockItems")}),(0,u.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:T.lowStock})]}),(0,u.jsxs)("div",{className:"bg-red-50 p-3 rounded-lg",children:[(0,u.jsx)("p",{className:"text-sm text-gray-600",children:W("outOfStock")}),(0,u.jsx)("p",{className:"text-2xl font-bold text-red-600",children:T.outOfStock})]}),(0,u.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,u.jsx)("p",{className:"text-sm text-gray-600",children:W("inventoryValue")}),(0,u.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:["\u20a6",(null===(s=T.totalValue)||void 0===s?void 0:s.toLocaleString())||0]})]})]})]})]})}),(0,u.jsx)("div",{className:"mb-8",children:F?(0,u.jsx)("div",{className:"text-yellow-600",children:W("checkingLowStock")}):O?(0,u.jsx)("div",{className:"text-red-500",children:O}):S.length>0?(0,u.jsxs)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg mb-4",children:[(0,u.jsxs)("div",{className:"flex items-center font-bold text-yellow-800 mb-2",children:[(0,u.jsx)(p.BS8,{className:"mr-2 text-yellow-600"}),W("lowStockAlert")]}),(0,u.jsx)("div",{className:"overflow-x-auto",children:(0,u.jsxs)("table",{className:"min-w-full bg-white/90 rounded shadow text-base",children:[(0,u.jsx)("thead",{className:"bg-yellow-100",children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{className:"px-3 py-2 text-left font-bold text-yellow-700 uppercase tracking-wider",children:W("product")}),(0,u.jsx)("th",{className:"px-3 py-2 text-left font-bold text-yellow-700 uppercase tracking-wider",children:W("stock")}),(0,u.jsx)("th",{className:"px-3 py-2 text-left font-bold text-yellow-700 uppercase tracking-wider",children:W("category")}),(0,u.jsx)("th",{className:"px-3 py-2 text-left font-bold text-yellow-700 uppercase tracking-wider",children:W("action")})]})}),(0,u.jsx)("tbody",{children:S.map((e=>{var s;return(0,u.jsxs)("tr",{className:"hover:bg-yellow-50",children:[(0,u.jsx)("td",{className:"px-3 py-2",children:e.name}),(0,u.jsx)("td",{className:"px-3 py-2 font-bold text-red-600",children:e.countInStock}),(0,u.jsx)("td",{className:"px-3 py-2",children:(null===(s=e.category)||void 0===s?void 0:s.name)||"N/A"}),(0,u.jsx)("td",{className:"px-3 py-2",children:(0,u.jsx)(r.N_,{to:"/admin/product/".concat(e._id,"/edit"),className:"text-blue-600 hover:text-blue-800 underline",children:W("updateStock")})})]},e._id)}))})]})})]}):(0,u.jsx)("div",{className:"text-green-700 bg-green-50 p-3 rounded-lg inline-block",children:W("noProductsLowStock")})}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-10",children:[(0,u.jsxs)(r.N_,{to:"/admin/users",className:"card-haven flex flex-col items-center py-8 hover:scale-[1.03] transition-all duration-200",children:[(0,u.jsx)("div",{className:"flex items-center justify-center bg-blue-100 rounded-full w-16 h-16 mb-3",children:(0,u.jsx)(p.YXz,{className:"text-blue-500 text-2xl"})}),(0,u.jsx)("div",{className:"text-4xl font-extrabold text-primary-400 mb-2",children:g.length}),(0,u.jsx)("div",{className:"text-lg text-primary-700 font-semibold",children:W("users")}),(0,u.jsx)("div",{className:"text-sm text-gray-500 mt-1",children:W("manageUsers")})]}),(0,u.jsxs)(r.N_,{to:"/admin/products",className:"card-haven flex flex-col items-center py-8 hover:scale-[1.03] transition-all duration-200",children:[(0,u.jsx)("div",{className:"flex items-center justify-center bg-pink-100 rounded-full w-16 h-16 mb-3",children:(0,u.jsx)(p.H5e,{className:"text-pink-500 text-2xl"})}),(0,u.jsx)("div",{className:"text-4xl font-extrabold text-pink-400 mb-2",children:v.length}),(0,u.jsx)("div",{className:"text-lg text-primary-700 font-semibold",children:W("products")}),(0,u.jsx)("div",{className:"text-sm text-gray-500 mt-1",children:W("manageProducts")})]}),(0,u.jsxs)(r.N_,{to:"/admin/orders",className:"card-haven flex flex-col items-center py-8 hover:scale-[1.03] transition-all duration-200",children:[(0,u.jsx)("div",{className:"flex items-center justify-center bg-green-100 rounded-full w-16 h-16 mb-3",children:(0,u.jsx)(p.AsH,{className:"text-green-500 text-2xl"})}),(0,u.jsx)("div",{className:"text-4xl font-extrabold text-blue-400 mb-2",children:w.length}),(0,u.jsx)("div",{className:"text-lg text-primary-700 font-semibold",children:W("orders")}),(0,u.jsx)("div",{className:"text-sm text-gray-500 mt-1",children:W("manageOrders")})]})]}),(0,u.jsxs)("div",{className:"card-haven py-8",children:[(0,u.jsx)("div",{className:"text-xl font-semibold mb-6 text-primary-700",children:W("recentOrders")}),(0,u.jsx)("div",{className:"overflow-x-auto",children:(0,u.jsxs)("table",{className:"min-w-full bg-white/90 rounded-2xl shadow-card-haven text-base",children:[(0,u.jsx)("thead",{className:"bg-primary-50",children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{className:"px-3 py-4 text-left font-bold text-primary-400 uppercase tracking-wider",children:W("orderId")}),(0,u.jsx)("th",{className:"px-3 py-4 text-left font-bold text-primary-400 uppercase tracking-wider",children:W("user")}),(0,u.jsx)("th",{className:"px-3 py-4 text-left font-bold text-primary-400 uppercase tracking-wider",children:W("total")}),(0,u.jsx)("th",{className:"px-3 py-4 text-left font-bold text-primary-400 uppercase tracking-wider",children:W("status")}),(0,u.jsx)("th",{className:"px-3 py-4 text-left font-bold text-primary-400 uppercase tracking-wider",children:W("date")})]})}),(0,u.jsx)("tbody",{className:"divide-y divide-primary-50",children:K.map((e=>{var s,t;return(0,u.jsxs)("tr",{className:"hover:bg-blue-50/60 transition",children:[(0,u.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-primary-700 font-mono font-semibold",children:e._id}),(0,u.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-primary-700",children:(null===(s=e.user)||void 0===s?void 0:s.name)||"N/A"}),(0,u.jsxs)("td",{className:"px-3 py-4 whitespace-nowrap text-pink-500 font-bold",children:["\u20a6",null===(t=e.totalPrice)||void 0===t?void 0:t.toLocaleString()]}),(0,u.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,u.jsx)("span",{className:"px-3 py-1 inline-flex text-sm leading-5 font-semibold rounded-full shadow ".concat(e.isPaid?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"),children:e.isPaid?"Paid":"Pending"})}),(0,u.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-primary-700",children:new Date(e.createdAt).toLocaleDateString()})]},e._id)}))})]})})]})]})]})}}}]);
//# sourceMappingURL=642.406fc150.chunk.js.map