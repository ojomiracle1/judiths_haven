(self.webpackChunkmama_miracle_boutique_frontend=self.webpackChunkmama_miracle_boutique_frontend||[]).push([[984],{984:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>p});var a=o(9379),n=o(5043),r=o(5475),s=o(3003),l=o(7227),i=o(3401),d=o(3204),c=o(2450),u=o(579);const p=()=>{const e=(0,s.wA)(),{products:t,isLoading:o,isError:p,message:x}=(0,s.d4)((e=>e.product)),[m,f]=(0,n.useState)(new Set),[h,g]=(0,n.useState)(1),[b,v]=(0,n.useState)(10),[y,w]=(0,n.useState)([]),[j,N]=(0,n.useState)(!1),[k,E]=(0,n.useState)(!1),[A,S]=(0,n.useState)(!1),[C,R]=(0,n.useState)({category:"",status:"",featured:!1}),[_,L]=(0,n.useState)(!1);(0,n.useEffect)((()=>{p&&i.oR.error(x),e((0,l.d$)({page:h,limit:b})),w([]),N(!1)}),[e,p,x,h,b]);const U=async e=>{L(!0);try{console.log("Exporting products as ".concat(e,"..."));const t=await d.A.get("/api/products/export?format=".concat(e),{responseType:"blob"});if(!t.data)throw new Error("No data received from server");const o="products.".concat("excel"===e?"xlsx":"csv");(0,c.saveAs)(t.data,o),i.oR.success("Exported as ".concat(e.toUpperCase())),console.log("Export successful: ".concat(o))}catch(a){var t,o;console.error("Export error:",a),console.error("Error response:",a.response);const e=(null===(t=a.response)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.message)||a.message||"Export failed";i.oR.error("Export failed: ".concat(e))}finally{L(!1)}},D=Math.ceil(t.length/b)||1;return o?(0,u.jsx)("div",{className:"flex justify-center items-center min-h-screen bg-gradient-to-br from-pink-50 via-blue-50 to-green-50",children:(0,u.jsxs)("div",{className:"text-center",children:[(0,u.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-400 mx-auto mb-4"}),(0,u.jsx)("p",{className:"text-gray-600",children:"Loading products..."})]})}):(0,u.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-10",children:[y.length>0&&(0,u.jsxs)("div",{className:"mb-4 flex flex-col sm:flex-row gap-2 items-center justify-between bg-blue-50 border border-blue-200 rounded-xl p-3 shadow",children:[(0,u.jsxs)("span",{className:"font-semibold text-blue-800",children:[y.length," selected"]}),(0,u.jsxs)("div",{className:"flex gap-2",children:[(0,u.jsx)("button",{onClick:async()=>{if(0!==y.length&&window.confirm("Delete ".concat(y.length," products? This cannot be undone!"))){E(!0);try{await d.A.post("/products/bulk-delete",{productIds:y}),i.oR.success("Products deleted"),e((0,l.d$)({page:h,limit:b})),w([]),N(!1)}catch(a){var t,o;i.oR.error((null===(t=a.response)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.message)||"Bulk delete failed")}finally{E(!1)}}},disabled:k,className:"bg-gradient-to-r from-red-200 to-pink-200 hover:from-red-300 hover:to-pink-300 text-red-900 font-semibold rounded-lg px-4 py-1 shadow focus:outline-none focus:ring-2 focus:ring-red-200 transition-all duration-150",children:k?"Deleting...":"Bulk Delete"}),(0,u.jsx)("button",{onClick:()=>S(!0),disabled:k,className:"bg-gradient-to-r from-green-200 to-blue-200 hover:from-green-300 hover:to-blue-300 text-blue-900 font-semibold rounded-lg px-4 py-1 shadow focus:outline-none focus:ring-2 focus:ring-blue-200 transition-all duration-150",children:"Bulk Update"})]})]}),A&&(0,u.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,u.jsxs)("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md",children:[(0,u.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Bulk Update Products"}),(0,u.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),E(!0);try{await d.A.put("/products/bulk-update",{productIds:y,update:C}),i.oR.success("Products updated"),e((0,l.d$)({page:h,limit:b})),w([]),N(!1),S(!1),R({category:"",status:"",featured:!1})}catch(n){var o,a;i.oR.error((null===(o=n.response)||void 0===o||null===(a=o.data)||void 0===a?void 0:a.message)||"Bulk update failed")}finally{E(!1)}},className:"space-y-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block font-semibold mb-1",children:"Category ID"}),(0,u.jsx)("input",{type:"text",value:C.category,onChange:e=>R((t=>(0,a.A)((0,a.A)({},t),{},{category:e.target.value}))),className:"w-full border rounded px-2 py-1",placeholder:"Category ID (optional)"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block font-semibold mb-1",children:"Status"}),(0,u.jsxs)("select",{value:C.status,onChange:e=>R((t=>(0,a.A)((0,a.A)({},t),{},{status:e.target.value}))),className:"w-full border rounded px-2 py-1",children:[(0,u.jsx)("option",{value:"",children:"-- No Change --"}),(0,u.jsx)("option",{value:"active",children:"Active"}),(0,u.jsx)("option",{value:"inactive",children:"Inactive"})]})]}),(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsx)("input",{type:"checkbox",checked:C.featured,onChange:e=>R((t=>(0,a.A)((0,a.A)({},t),{},{featured:e.target.checked}))),id:"featured"}),(0,u.jsx)("label",{htmlFor:"featured",className:"font-semibold",children:"Set as Featured"})]}),(0,u.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,u.jsx)("button",{type:"button",onClick:()=>S(!1),className:"px-4 py-1 rounded bg-gray-200",disabled:k,children:"Cancel"}),(0,u.jsx)("button",{type:"submit",className:"px-4 py-1 rounded bg-blue-500 text-white font-semibold",disabled:k,children:k?"Updating...":"Update"})]})]})]})}),(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-8 gap-4",children:[(0,u.jsx)("h1",{className:"text-4xl font-extrabold text-gray-800 tracking-tight drop-shadow-lg",children:"Products"}),(0,u.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,u.jsx)(r.N_,{to:"/admin/product/new",className:"bg-gradient-to-r from-pink-200 to-blue-200 hover:from-pink-300 hover:to-blue-300 text-blue-900 font-semibold rounded-xl px-6 py-2 shadow transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-pink-200",children:"+ Add Product"}),(0,u.jsxs)("div",{className:"relative",children:[(0,u.jsx)("button",{className:"bg-gradient-to-r from-green-200 to-blue-200 hover:from-green-300 hover:to-blue-300 text-blue-900 font-semibold rounded-xl px-4 py-2 shadow transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-200",disabled:_,onClick:()=>U("csv"),children:_?"Exporting...":"Export CSV"}),(0,u.jsx)("button",{className:"ml-2 bg-gradient-to-r from-blue-200 to-green-200 hover:from-blue-300 hover:to-green-300 text-green-900 font-semibold rounded-xl px-4 py-2 shadow transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-200",disabled:_,onClick:()=>U("excel"),children:_?"Exporting...":"Export Excel"})]})]})]}),0===t.length?(0,u.jsx)("div",{className:"text-center py-16 bg-white/70 rounded-2xl shadow-inner",children:(0,u.jsx)("p",{className:"text-gray-500 text-lg",children:"No products found."})}):(0,u.jsx)("div",{className:"overflow-x-auto",children:(0,u.jsx)("div",{className:"bg-white/80 shadow-2xl rounded-3xl p-4 sm:p-8 border border-blue-100",children:(0,u.jsxs)("table",{className:"min-w-full text-sm rounded-2xl overflow-hidden",children:[(0,u.jsx)("thead",{className:"bg-gradient-to-r from-pink-100/80 to-blue-100/80",children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{className:"px-2 py-3",children:(0,u.jsx)("input",{type:"checkbox",checked:j,onChange:()=>{j?(w([]),N(!1)):(w(t.map((e=>e._id))),N(!0))},"aria-label":"Select all products"})}),(0,u.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"Image"}),(0,u.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"Name"}),(0,u.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"Price"}),(0,u.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"Category"}),(0,u.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"Brand"}),(0,u.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"Stock"}),(0,u.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),(0,u.jsx)("tbody",{className:"divide-y divide-blue-50",children:t.map((t=>(0,u.jsxs)("tr",{className:"hover:bg-pink-50/60 transition-all duration-150",children:[(0,u.jsx)("td",{className:"px-2 py-4",children:(0,u.jsx)("input",{type:"checkbox",checked:y.includes(t._id),onChange:()=>{return e=t._id,void w((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]));var e},"aria-label":"Select product ".concat(t.name)})}),(0,u.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,u.jsx)("img",{src:t.images[0],alt:t.name,className:"h-12 w-12 object-cover rounded-xl shadow border border-blue-100 bg-white"})}),(0,u.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-gray-800 font-semibold",children:t.name}),(0,u.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap text-gray-700",children:["\u20a6",t.price.toFixed(2)]}),(0,u.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-gray-700",children:t.category.name}),(0,u.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-gray-700",children:t.brand}),(0,u.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-gray-700",children:t.countInStock}),(0,u.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,u.jsx)(r.N_,{to:"/admin/product/".concat(t._id,"/edit"),className:"bg-gradient-to-r from-blue-200 to-green-200 hover:from-blue-300 hover:to-green-300 text-blue-900 font-semibold rounded-lg px-4 py-1 shadow focus:outline-none focus:ring-2 focus:ring-blue-200 transition-all duration-150",children:"Edit"}),(0,u.jsx)("button",{onClick:()=>{return o=t._id,void(window.confirm("Are you sure you want to delete this product?")&&(f((e=>new Set(e).add(o))),e((0,l.DD)(o)).unwrap().then((()=>{i.oR.success("Product deleted successfully")})).catch((e=>{i.oR.error(e)})).finally((()=>{f((e=>{const t=new Set(e);return t.delete(o),t}))}))));var o},disabled:m.has(t._id),className:"bg-gradient-to-r from-red-200 to-pink-200 hover:from-red-300 hover:to-pink-300 text-red-900 font-semibold rounded-lg px-4 py-1 shadow focus:outline-none focus:ring-2 focus:ring-red-200 transition-all duration-150 ".concat(m.has(t._id)?"opacity-50 cursor-not-allowed":""),children:m.has(t._id)?(0,u.jsxs)("span",{className:"flex items-center",children:[(0,u.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-red-600 mr-2"}),"Deleting..."]}):"Delete"})]})})]},t._id)))})]})})}),(0,u.jsxs)("div",{className:"flex justify-between items-center mt-6",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"limit",className:"mr-2",children:"Per page:"}),(0,u.jsx)("select",{id:"limit",value:b,onChange:e=>v(Number(e.target.value)),children:[5,10,20,50].map((e=>(0,u.jsx)("option",{value:e,children:e},e)))})]}),(0,u.jsx)("div",{children:Array.from({length:D},((e,t)=>t+1)).map((e=>(0,u.jsx)("button",{onClick:()=>g(e),className:"mx-1 px-3 py-1 rounded ".concat(e===h?"bg-blue-500 text-white":"bg-gray-200"),children:e},e)))})]})]})}},2450:function(e,t,o){var a,n,r;n=[],void 0===(r="function"===typeof(a=function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function a(e,t,o){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){i(a.response,t,o)},a.onerror=function(){console.error("could not download file")},a.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(a){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof o.g&&o.g.global===o.g?o.g:void 0,l=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),i=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,t,o){var l=s.URL||s.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener","string"==typeof e?(i.href=e,i.origin===location.origin?r(i):n(i.href)?a(e,t,o):r(i,i.target="_blank")):(i.href=l.createObjectURL(e),setTimeout((function(){l.revokeObjectURL(i.href)}),4e4),setTimeout((function(){r(i)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,o,s){if(o=o||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,s),o);else if(n(e))a(e,o,s);else{var l=document.createElement("a");l.href=e,l.target="_blank",setTimeout((function(){r(l)}))}}:function(e,t,o,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return a(e,t,o);var r="application/octet-stream"===e.type,i=/constructor/i.test(s.HTMLElement)||s.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||r&&i||l)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=d?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},c.readAsDataURL(e)}else{var u=s.URL||s.webkitURL,p=u.createObjectURL(e);n?n.location=p:location.href=p,n=null,setTimeout((function(){u.revokeObjectURL(p)}),4e4)}});s.saveAs=i.saveAs=i,e.exports=i})?a.apply(t,n):a)||(e.exports=r)}}]);
//# sourceMappingURL=984.5f35bb94.chunk.js.map