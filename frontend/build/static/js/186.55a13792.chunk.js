"use strict";(self.webpackChunkmama_miracle_boutique_frontend=self.webpackChunkmama_miracle_boutique_frontend||[]).push([[186],{6186:(e,a,t)=>{t.r(a),t.d(a,{default:()=>c});var s=t(9379),l=t(5043),r=t(9722),n=t(3401),d=t(579);const c=()=>{const[e,a]=(0,l.useState)([]),[t,c]=(0,l.useState)(1),[i,x]=(0,l.useState)(1),[o,p]=(0,l.useState)(0),[m,u]=(0,l.useState)(20),[h,y]=(0,l.useState)(!1),[j,b]=(0,l.useState)(""),[g,N]=(0,l.useState)({user:"",action:"",startDate:"",endDate:"",search:""}),f=async()=>{y(!0),b("");try{const e=(0,s.A)({page:t,limit:m},g);Object.keys(e).forEach((a=>""===e[a]?delete e[a]:null));const l=await r.A.get("/api/audit-logs",{params:e});a(l.data.logs),x(l.data.pages),p(l.data.total)}catch(e){b("Failed to fetch logs"),n.oR.error("Failed to fetch logs")}finally{y(!1)}};(0,l.useEffect)((()=>{f()}),[t,m]);const v=e=>{N((a=>(0,s.A)((0,s.A)({},a),{},{[e.target.name]:e.target.value})))};return(0,d.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-10",children:[(0,d.jsx)("h1",{className:"text-4xl font-extrabold text-gray-800 mb-8",children:"Audit Logs"}),(0,d.jsxs)("form",{onSubmit:e=>{e.preventDefault(),c(1),f()},className:"flex flex-wrap gap-4 mb-6 items-end",children:[(0,d.jsx)("input",{type:"text",name:"search",value:g.search,onChange:v,placeholder:"Search action/details...",className:"border rounded px-3 py-2"}),(0,d.jsx)("input",{type:"text",name:"user",value:g.user,onChange:v,placeholder:"User ID",className:"border rounded px-3 py-2"}),(0,d.jsx)("input",{type:"text",name:"action",value:g.action,onChange:v,placeholder:"Action",className:"border rounded px-3 py-2"}),(0,d.jsx)("input",{type:"date",name:"startDate",value:g.startDate,onChange:v,className:"border rounded px-3 py-2"}),(0,d.jsx)("input",{type:"date",name:"endDate",value:g.endDate,onChange:v,className:"border rounded px-3 py-2"}),(0,d.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded font-semibold shadow",children:"Filter/Search"})]}),h?(0,d.jsx)("div",{className:"text-center py-10",children:"Loading..."}):j?(0,d.jsx)("div",{className:"text-center text-red-500 py-10",children:j}):(0,d.jsxs)("div",{className:"overflow-x-auto bg-white rounded-xl shadow p-4",children:[(0,d.jsxs)("table",{className:"min-w-full text-sm",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{className:"bg-blue-50",children:[(0,d.jsx)("th",{className:"px-4 py-2 text-left",children:"User"}),(0,d.jsx)("th",{className:"px-4 py-2 text-left",children:"Action"}),(0,d.jsx)("th",{className:"px-4 py-2 text-left",children:"Details"}),(0,d.jsx)("th",{className:"px-4 py-2 text-left",children:"Timestamp"})]})}),(0,d.jsx)("tbody",{children:0===e.length?(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:4,className:"text-center py-8 text-gray-500",children:"No logs found."})}):e.map((e=>(0,d.jsxs)("tr",{className:"border-b hover:bg-blue-50",children:[(0,d.jsx)("td",{className:"px-4 py-2",children:e.user?(0,d.jsx)("span",{title:e.user.email,children:e.user.name||e.user.email}):(0,d.jsx)("span",{className:"italic text-gray-400",children:"System"})}),(0,d.jsx)("td",{className:"px-4 py-2",children:e.action}),(0,d.jsx)("td",{className:"px-4 py-2",children:(0,d.jsx)("pre",{className:"whitespace-pre-wrap break-all text-xs bg-gray-50 rounded p-2 max-w-xs overflow-x-auto",children:JSON.stringify(e.details,null,2)})}),(0,d.jsx)("td",{className:"px-4 py-2",children:new Date(e.createdAt).toLocaleString()})]},e._id)))})]}),(0,d.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,d.jsxs)("div",{children:["Total: ",o]}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)("button",{onClick:()=>c((e=>Math.max(1,e-1))),disabled:1===t,className:"px-3 py-1 rounded bg-gray-200",children:"Prev"}),(0,d.jsxs)("span",{children:["Page ",t," of ",i]}),(0,d.jsx)("button",{onClick:()=>c((e=>Math.min(i,e+1))),disabled:t===i,className:"px-3 py-1 rounded bg-gray-200",children:"Next"}),(0,d.jsx)("select",{value:m,onChange:e=>{u(Number(e.target.value)),c(1)},className:"ml-2 px-2 py-1 rounded border",children:[10,20,50,100].map((e=>(0,d.jsxs)("option",{value:e,children:[e," per page"]},e)))})]})]})]})]})}}}]);
//# sourceMappingURL=186.55a13792.chunk.js.map