(self.webpackChunkmama_miracle_boutique_frontend=self.webpackChunkmama_miracle_boutique_frontend||[]).push([[123],{2450:function(e,t,n){var r,s,a;s=[],void 0===(a="function"===typeof(r=function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function r(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){i(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function s(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,l=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),i=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,t,n){var l=o.URL||o.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener","string"==typeof e?(i.href=e,i.origin===location.origin?a(i):s(i.href)?r(e,t,n):a(i,i.target="_blank")):(i.href=l.createObjectURL(e),setTimeout((function(){l.revokeObjectURL(i.href)}),4e4),setTimeout((function(){a(i)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,o){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,o),n);else if(s(e))r(e,n,o);else{var l=document.createElement("a");l.href=e,l.target="_blank",setTimeout((function(){a(l)}))}}:function(e,t,n,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof e)return r(e,t,n);var a="application/octet-stream"===e.type,i=/constructor/i.test(o.HTMLElement)||o.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||a&&i||l)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=d?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=e:location=e,s=null},c.readAsDataURL(e)}else{var u=o.URL||o.webkitURL,p=u.createObjectURL(e);s?s.location=p:location.href=p,s=null,setTimeout((function(){u.revokeObjectURL(p)}),4e4)}});o.saveAs=i.saveAs=i,e.exports=i})?r.apply(t,s):r)||(e.exports=a)},7123:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>x});var r=n(9379),s=n(5043),a=n(5475),o=n(3003),l=n(963),i=n(3401),d=n(2104),c=n(9722),u=n(2450),p=n(579);const x=()=>{const e=(0,o.wA)(),{orders:t,isLoading:n,isError:x,message:m}=(0,o.d4)((e=>e.order)),[f,h]=(0,s.useState)(""),[g,b]=(0,s.useState)([]),[v,w]=(0,s.useState)(new Set),[y,j]=(0,s.useState)(1),[N,k]=(0,s.useState)(10),[S,_]=(0,s.useState)([]),[R,E]=(0,s.useState)(!1),[C,A]=(0,s.useState)(!1),[D,U]=(0,s.useState)(!1),[O,L]=(0,s.useState)({status:""}),[T,B]=(0,s.useState)(!1);(0,s.useEffect)((()=>{x&&i.oR.error(m),e((0,l.WF)({page:y,limit:N})),_([]),E(!1)}),[e,x,m,y,N]),(0,s.useEffect)((()=>{const n=(0,d.io)("/",{transports:["websocket"]});return t&&t.length>0&&t.forEach((e=>{n.emit("joinOrderRoom",e._id)})),n.on("orderStatusUpdate",(t=>{i.oR.info("Order #".concat(t.orderId," status updated: ").concat(t.status)),e((0,l.WF)())})),()=>{n.disconnect()}}),[t,e]),(0,s.useEffect)((()=>{b(f?t.filter((e=>e._id.includes(f)||e.user&&e.user.name&&e.user.name.toLowerCase().includes(f.toLowerCase()))):t)}),[f,t]);const F=async e=>{B(!0);try{const t=await c.A.get("/api/orders/export?format=".concat(e),{responseType:"blob"}),n="orders.".concat("excel"===e?"xlsx":"csv");(0,u.saveAs)(t.data,n),i.oR.success("Exported as ".concat(e.toUpperCase()))}catch(t){i.oR.error("Export failed")}finally{B(!1)}},M=Math.ceil(g.length/N)||1;return n?(0,p.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto mb-4"}),(0,p.jsx)("p",{className:"text-gray-600",children:"Loading orders..."})]})}):(0,p.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-10",children:[S.length>0&&(0,p.jsxs)("div",{className:"mb-4 flex flex-col sm:flex-row gap-2 items-center justify-between bg-blue-50 border border-blue-200 rounded-xl p-3 shadow",children:[(0,p.jsxs)("span",{className:"font-semibold text-blue-800",children:[S.length," selected"]}),(0,p.jsxs)("div",{className:"flex gap-2",children:[(0,p.jsx)("button",{onClick:async()=>{if(0!==S.length&&window.confirm("Delete ".concat(S.length," orders? This cannot be undone!"))){A(!0);try{await c.A.post("/api/orders/bulk-delete",{orderIds:S}),i.oR.success("Orders deleted"),e((0,l.WF)({page:y,limit:N})),_([]),E(!1)}catch(r){var t,n;i.oR.error((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Bulk delete failed")}finally{A(!1)}}},disabled:C,className:"bg-gradient-to-r from-red-200 to-pink-200 hover:from-red-300 hover:to-pink-300 text-red-900 font-semibold rounded-lg px-4 py-1 shadow focus:outline-none focus:ring-2 focus:ring-red-200 transition-all duration-150",children:C?"Deleting...":"Bulk Delete"}),(0,p.jsx)("button",{onClick:()=>U(!0),disabled:C,className:"bg-gradient-to-r from-green-200 to-blue-200 hover:from-green-300 hover:to-blue-300 text-blue-900 font-semibold rounded-lg px-4 py-1 shadow focus:outline-none focus:ring-2 focus:ring-blue-200 transition-all duration-150",children:"Bulk Update Status"})]})]}),D&&(0,p.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,p.jsxs)("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md",children:[(0,p.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Bulk Update Orders"}),(0,p.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),A(!0);try{await c.A.put("/api/orders/bulk-update",{orderIds:S,update:O}),i.oR.success("Orders updated"),e((0,l.WF)({page:y,limit:N})),_([]),E(!1),U(!1),L({status:""})}catch(s){var n,r;i.oR.error((null===(n=s.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||"Bulk update failed")}finally{A(!1)}},className:"space-y-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block font-semibold mb-1",children:"Status"}),(0,p.jsxs)("select",{value:O.status,onChange:e=>L((t=>(0,r.A)((0,r.A)({},t),{},{status:e.target.value}))),className:"w-full border rounded px-2 py-1",children:[(0,p.jsx)("option",{value:"",children:"-- No Change --"}),(0,p.jsx)("option",{value:"pending",children:"Pending"}),(0,p.jsx)("option",{value:"processing",children:"Processing"}),(0,p.jsx)("option",{value:"shipped",children:"Shipped"}),(0,p.jsx)("option",{value:"delivered",children:"Delivered"}),(0,p.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,p.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,p.jsx)("button",{type:"button",onClick:()=>U(!1),className:"px-4 py-1 rounded bg-gray-200",disabled:C,children:"Cancel"}),(0,p.jsx)("button",{type:"submit",className:"px-4 py-1 rounded bg-blue-500 text-white font-semibold",disabled:C,children:C?"Updating...":"Update"})]})]})]})}),(0,p.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-8 gap-4",children:[(0,p.jsx)("h1",{className:"text-4xl font-extrabold text-gray-800 tracking-tight drop-shadow-lg",children:"All Orders"}),(0,p.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,p.jsx)("input",{type:"text",placeholder:"Search by Order ID or User Name",value:f,onChange:e=>h(e.target.value),className:"input-premium w-full sm:w-64"}),(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsx)("button",{className:"bg-gradient-to-r from-green-200 to-blue-200 hover:from-green-300 hover:to-blue-300 text-blue-900 font-semibold rounded-xl px-4 py-2 shadow transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-200",disabled:T,onClick:()=>F("csv"),children:T?"Exporting...":"Export CSV"}),(0,p.jsx)("button",{className:"ml-2 bg-gradient-to-r from-blue-200 to-green-200 hover:from-blue-300 hover:to-green-300 text-green-900 font-semibold rounded-xl px-4 py-2 shadow transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-200",disabled:T,onClick:()=>F("excel"),children:T?"Exporting...":"Export Excel"})]})]})]}),0===g.length?(0,p.jsx)("div",{className:"text-center py-16 bg-white/70 rounded-2xl shadow-inner",children:(0,p.jsx)("p",{className:"text-gray-500 text-lg",children:"No orders found."})}):(0,p.jsx)("div",{className:"overflow-x-auto",children:(0,p.jsx)("div",{className:"bg-white/80 shadow-2xl rounded-3xl p-4 sm:p-8 border border-blue-100",children:(0,p.jsxs)("table",{className:"min-w-full text-sm rounded-2xl overflow-hidden",children:[(0,p.jsx)("thead",{className:"bg-gradient-to-r from-pink-100/80 to-blue-100/80",children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{className:"px-2 py-3",children:(0,p.jsx)("input",{type:"checkbox",checked:R,onChange:()=>{R?(_([]),E(!1)):(_(g.map((e=>e._id))),E(!0))},"aria-label":"Select all orders"})}),(0,p.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"Order ID"}),(0,p.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"User"}),(0,p.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"Date"}),(0,p.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"Total"}),(0,p.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"Payment Status"}),(0,p.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"Delivery Status"}),(0,p.jsx)("th",{className:"px-4 py-3 text-left font-bold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),(0,p.jsx)("tbody",{className:"divide-y divide-blue-50",children:g.map((t=>{var n;return(0,p.jsxs)("tr",{className:"hover:bg-pink-50/60 transition-all duration-150",children:[(0,p.jsx)("td",{className:"px-2 py-4",children:(0,p.jsx)("input",{type:"checkbox",checked:S.includes(t._id),onChange:()=>{return e=t._id,void _((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]));var e},"aria-label":"Select order ".concat(t._id)})}),(0,p.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-gray-800 font-semibold",children:t._id}),(0,p.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-gray-700",children:(null===(n=t.user)||void 0===n?void 0:n.name)||"Unknown User"}),(0,p.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-gray-500",children:new Date(t.createdAt).toLocaleDateString()}),(0,p.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap text-gray-800",children:["\u20a6",t.totalPrice]}),(0,p.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,p.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(t.isPaid?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:t.isPaid?"Paid":"Not Paid"})}),(0,p.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,p.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(t.isDelivered?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:t.isDelivered?"Delivered":"Not Delivered"})}),(0,p.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,p.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,p.jsx)(a.N_,{to:"/admin/order/".concat(t._id),className:"bg-gradient-to-r from-blue-200 to-green-200 hover:from-blue-300 hover:to-green-300 text-blue-900 font-semibold rounded-lg px-4 py-1 shadow focus:outline-none focus:ring-2 focus:ring-blue-200 transition-all duration-150",children:"Details"}),t.isDelivered?(0,p.jsx)("button",{onClick:()=>{return n=t._id,w((e=>new Set(e).add(n))),void e((0,l.zI)(n)).unwrap().then((()=>{i.oR.success("Order unmarked as delivered"),e((0,l.WF)())})).catch((e=>i.oR.error(e))).finally((()=>{w((e=>{const t=new Set(e);return t.delete(n),t}))}));var n},disabled:v.has(t._id),className:"bg-gradient-to-r from-yellow-200 to-pink-200 hover:from-yellow-300 hover:to-pink-300 text-yellow-900 font-semibold rounded-lg px-4 py-1 shadow focus:outline-none focus:ring-2 focus:ring-yellow-200 transition-all duration-150 ".concat(v.has(t._id)?"opacity-50 cursor-not-allowed":""),children:v.has(t._id)?(0,p.jsxs)("span",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-yellow-600 mr-2"}),"Updating..."]}):"Unmark as Delivered"}):(0,p.jsx)("button",{onClick:()=>{return n=t._id,w((e=>new Set(e).add(n))),void e((0,l.Fv)(n)).unwrap().then((()=>{i.oR.success("Order marked as delivered"),e((0,l.WF)())})).catch((e=>i.oR.error(e))).finally((()=>{w((e=>{const t=new Set(e);return t.delete(n),t}))}));var n},disabled:v.has(t._id),className:"bg-gradient-to-r from-green-200 to-blue-200 hover:from-green-300 hover:to-blue-300 text-green-900 font-semibold rounded-lg px-4 py-1 shadow focus:outline-none focus:ring-2 focus:ring-green-200 transition-all duration-150 ".concat(v.has(t._id)?"opacity-50 cursor-not-allowed":""),children:v.has(t._id)?(0,p.jsxs)("span",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-green-600 mr-2"}),"Updating..."]}):"Mark as Delivered"})]})})]},t._id)}))})]})})}),(0,p.jsxs)("div",{className:"flex justify-between items-center mt-6",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"limit",className:"mr-2",children:"Per page:"}),(0,p.jsx)("select",{id:"limit",value:N,onChange:e=>k(Number(e.target.value)),children:[5,10,20,50].map((e=>(0,p.jsx)("option",{value:e,children:e},e)))})]}),(0,p.jsx)("div",{children:Array.from({length:M},((e,t)=>t+1)).map((e=>(0,p.jsx)("button",{onClick:()=>j(e),className:"mx-1 px-3 py-1 rounded ".concat(e===y?"bg-blue-500 text-white":"bg-gray-200"),children:e},e)))})]})]})}}}]);
//# sourceMappingURL=123.3a6d74ac.chunk.js.map